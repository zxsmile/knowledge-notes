容器 镜像 服务

**1.  镜像（Image）**：类似于虚拟机中的镜像，是一个包含有文件系统的面向Docker引擎的只读模板。任何应用程序运行都需要环境，而镜像就是用来提供这种运行环境的。例如一个Ubuntu镜像就是一个包含Ubuntu操作系统环境的模板，同理在该镜像上装上Apache软件，就可以称为Apache镜像。

**2.  容器（Container）**：类似于一个轻量级的沙盒，可以将其看作一个极简的Linux系统环境（包括root权限、进程空间、用户空间和网络空间等），以及运行在其中的应用程序。Docker引擎利用容器来运行、隔离各个应用。容器是镜像创建的应用实例，可以创建、启动、停止、删除容器，各个容器之间是是相互隔离的，互不影响。*注意：镜像本身是只读的，容器从镜像启动时，Docker在镜像的上层创建一个可写层，镜像本身不变。*

**3.  仓库（Repository）**：类似于代码仓库，这里是镜像仓库，是Docker用来集中存放镜像文件的地方。注意与注册服务器（Registry）的区别：注册服务器是存放仓库的地方，一般会有多个仓库；而仓库是存放镜像的地方，一般每个仓库存放一类镜像，每个镜像利用tag进行区分，比如Ubuntu仓库存放有多个版本（12.04、14.04等）的Ubuntu镜像。

![package35](.\images\package35.png)



新建 `Dockerfile` 文件
Dockerfile 是一个文本文档，其中包含了构建 Docker 镜像所需的所有命令。它是创建自定义 Docker 镜像的关键组件。
在项目根目录下创建一个 `Dockerfile` 文件，将以下配置粘进去：

```
# 从 nginx 镜像开始构建
FROM nginx

# 将项目根目录下的 dist 目录中的内容复制到容器的 /usr/share/nginx/html 目录中，作为静态文件目录
COPY ./dist /usr/share/nginx/html

# 将项目目录下的 nginx.conf 文件复制到容器的 /etc/nginx/nginx.conf 路径下，以配置 nginx
COPY nginx.conf /etc/nginx/nginx.conf

# 暴露 80 端口，使容器可以通过此端口对外提供服务
EXPOSE 80

# 启动 nginx，并以前台模式运行（-g "daemon off;" 表示在前台运行）
CMD ["nginx", "-g", "daemon off;"]


```

Dockerfile中常用的保留字有以下几个，更多请前往官网查阅：

- **FROM**：指定基础镜像
- **RUN**：容器构建时需要运行的命令
- **EXPOSE**：当前容器对外暴露的端口号
- **WORKDIR**：指定在创建容器后，终端默认登录进来的工作目录
- **ADD**：将宿主机目录下的文件拷贝进镜像，ADD命令会自动处理URL和解压tar压缩包
- **CMD**：指定一个容器启动时要运行的命令，参数为数组格式 CMD ["可执行文件", "参数1", "参数2" ...]

有了Dockerfile之后，就可以利用build命令构建镜像了：（其中-t用来指定新镜像的用户信息、tag等。最后的点表示在当前目录寻找Dockerfile。）



作者：明远湖之鱼
链接：https://juejin.cn/post/7313423853225361423
来源：稀土掘金
著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。